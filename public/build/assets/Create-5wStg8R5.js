import{r as y,m as re,e as H,j as u,L as se}from"./app-3E3PtKXV.js";import{A as ie}from"./AuthenticatedLayout-Al22e_c0.js";import{T as oe}from"./TopTools-dxst2J6M.js";import{u as J}from"./useTranslation-CyUEp7kq.js";import ae from"./ProjectStatusStep-BlGP-twj.js";import le from"./IndustrySelectionStep-BTQ4aMdL.js";import ce from"./BusinessTypeSelectionStep-gM9EUhyY.js";import de from"./ProjectDetailsStep-CxocDp-w.js";import ue from"./CreatingStep-aj-sOD4G.js";import pe from"./SuccessStep-EwP1NE6l.js";import me from"./BackgroundAnimationStyles-CSRb-eXc.js";import{A as fe}from"./index-CmVgNgTD.js";import"./StarBackground-DIxez7K7.js";import"./ApplicationLogo-BpWYQmhQ.js";import"./AuthIcon-FxtRzaIL.js";import"./createLucideIcon-KufGFvXY.js";import"./ProjectCreationHeader-DfUMakor.js";import"./proxy-BUtl0h-a.js";import"./chevron-right-CTWW6inQ.js";import"./chevron-left-Q1Sabpfk.js";import"./FormField-BXlbsQuF.js";import"./loader-circle-Dst3gbpF.js";import"./sparkles-BUDnPrHU.js";import"./NextButton-tIP6-0hh.js";import"./slash-D2t8Hpqq.js";import"./CustomScrollbarStyles-PcpXC8vi.js";import"./check-D1TDIsas.js";function _e({industries:L=[],businessTypes:P=[]}){const{t:i,i18n:v}=J(),[_,p]=y.useState("select"),[f,T]=y.useState(null),[t,c]=y.useState("name"),[k,B]=y.useState(!1),[h,g]=y.useState(!1),[F,x]=y.useState(null),[I,m]=y.useState({}),{data:r,setData:d,post:N,processing:z,errors:D}=re({name:"",description:"",status:"",industry_id:"",custom_industry:"",business_type_id:"",target_market:"",location:"",main_product_service:"",team_size:"",project_scale:"",revenue_model:"",main_differentiator:""}),o=[{key:"name",label:i("project_name"),placeholder:i("enter_project_name"),maxLength:255,showAiButton:!1},{key:"description",label:i("project_description"),placeholder:i("strat_writing_the_ai_will_help_you_enhance_it"),type:"textarea",showAiButton:!1},{key:"target_market",label:i("target_market"),placeholder:i("enter_target_market"),type:"textarea",maxLength:800,showAiButton:!0},{key:"location",label:i("location"),placeholder:i("enter_location"),type:"textarea",maxLength:255,showAiButton:!0},{key:"main_product_service",label:i("main_product_service"),placeholder:i("describe_main_product_service"),type:"textarea",showAiButton:!0},{key:"team_size",label:i("team_size"),placeholder:i("enter_team_size"),type:"number",min:1,max:9999,showAiButton:!1},{key:"project_scale",label:i("project_scale"),placeholder:i("select_project_scale"),type:"select",showAiButton:!1,options:[{value:"small",label:i("small_project")},{value:"medium",label:i("medium_project")},{value:"large",label:i("large_project")}]},{key:"revenue_model",label:i("revenue_model"),placeholder:i("describe_revenue_model"),type:"textarea",maxLength:500,showAiButton:!0},{key:"main_differentiator",label:i("main_differentiator"),placeholder:i("describe_main_differentiator"),type:"textarea",showAiButton:!0}];y.useEffect(()=>{var e;_==="details"&&!o.some(s=>s.key===t)&&c(((e=o[0])==null?void 0:e.key)||"name")},[_,t,o]);const w=(e,s)=>{const n=o.find(a=>a.key===e);if(!n)return null;if(!s&&e!=="team_size"&&e!=="project_scale")return i("field_required");if(n.maxLength&&s&&s.length>n.maxLength)return i("max_length_error",{length:n.maxLength});if(e==="team_size"&&s){const a=parseInt(s);if(isNaN(a)||a<1)return i("min_value_error",{min:1})}return null},R=e=>{const s=e?"existed_project":"new_project";T(e),d("status",s),p("industry")},A=(e,s=null)=>{if(e==="other"||e==="other-temp"){const n=L.find(a=>a.industry_name.toLowerCase().trim()==="other");n?d("industry_id",parseInt(n.id)):d("industry_id","other"),d("custom_industry",s)}else d("industry_id",parseInt(e)),d("custom_industry",null);p("businessType")},W=e=>{d("business_type_id",parseInt(e)),p("details")},q=()=>{if(_==="industry")p("select");else if(_==="businessType")p("industry");else if(_==="details"){const e=o.findIndex(s=>s.key===t);e>0?c(o[e-1].key):p("businessType")}},S=()=>{const e=o.findIndex(n=>n.key===t),s=w(t,r[t]);if(s){m(n=>({...n,[t]:s}));return}else m(n=>{const a={...n};return delete a[t],a});e<o.length-1&&c(o[e+1].key)},b=()=>{let e=!1;const s={};if(o.forEach(n=>{const a=w(n.key,r[n.key]);a&&(s[n.key]=a,e=!0)}),e){m(s);const n=o.find(a=>s[a.key]);n&&c(n.key);return}m({}),p("creating"),N(route("projects.store"),{onSuccess:()=>{p("success"),setTimeout(()=>{window.location.href=route("projects.index")},2e3)},onError:n=>{const a={};let V=!1;if(Object.keys(n).forEach(j=>{o.some(X=>X.key===j)&&(a[j]=n[j],V=!0)}),V){m(a);const j=o.find(X=>a[X.key]);j&&c(j.key)}p("details")}})},G=e=>{if(e.key==="Enter"&&(l==null?void 0:l.type)!=="textarea"&&(l==null?void 0:l.type)!=="select"){e.preventDefault();const s=o.findIndex(n=>n.key===t);r[t]&&r[t].toString().trim()&&(s<o.length-1?S():b())}else if(e.key==="Enter"&&e.ctrlKey&&(l==null?void 0:l.type)==="textarea"){e.preventDefault();const s=o.findIndex(n=>n.key===t);r[t]&&r[t].toString().trim()&&(s<o.length-1?S():b())}},K=e=>{if(t==="team_size"){const s=parseInt(e.target.value);(s>=0||e.target.value==="")&&(d(t,e.target.value),(s>0||e.target.value==="")&&m(n=>{const a={...n};return delete a[t],a}))}else{d(t,e.target.value);const s=o.find(n=>n.key===t);s&&s.maxLength&&e.target.value.length>s.maxLength?m(n=>({...n,[t]:i("max_length_error",{length:s.maxLength})})):m(n=>{const a={...n};return delete a[t],a})}},$=()=>{const e=o.findIndex(n=>n.key===t),s=w(t,r[t]);if(s){m(n=>({...n,[t]:s}));return}e<o.length-1?S():b()},M=async()=>{if(!(h||!r.industry_id||!r.business_type_id)){g(!0),x(t);try{const e=await H.post(route("ai.generate-field"),{field:t,project_data:{name:r.name,description:r.description,industry_id:r.industry_id,business_type_id:r.business_type_id},language:v.language},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});e.data&&e.data.content&&d(t,e.data.content)}catch(e){console.error(`Failed to generate content for ${t}:`,e)}finally{g(!1),x(null)}}},C=async()=>{if(!(h||k||!r.industry_id||!r.business_type_id)&&!(!r[t]||!r[t].trim())){t==="description"?B(!0):(g(!0),x(t));try{const e=await H.post(route("ai.enhance-field"),{field:t,current_content:r[t],project_data:{name:r.name,description:r.description,industry_id:r.industry_id,business_type_id:r.business_type_id},language:v.language},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});e.data&&e.data.content&&d(t,e.data.content)}catch(e){console.error(`Failed to enhance content for ${t}:`,e)}finally{t==="description"?B(!1):(g(!1),x(null))}}},E=()=>{r[t]&&r[t].trim()?C():M()},l=o.find(e=>e.key===t)||o[0],O=()=>o.findIndex(e=>e.key===t)+1,Q=()=>Math.round(O()/o.length*100),U=()=>O()===o.length,Y=()=>I[t]||h&&F===t||k&&t==="description"?!1:t==="team_size"?r[t]===""||r[t]&&parseInt(r[t])>0:(l==null?void 0:l.type)==="select"?!0:r[t]&&r[t].toString().trim(),Z=(l==null?void 0:l.showAiButton)||!1,ee=!r.industry_id||!r.business_type_id,te=(e=>!e||!e.trim()?0:e.trim().split(/\s+/).length)(r.description)>=3,ne=r.name&&r.business_type_id&&r.industry_id;return{step:_,projectStatus:f,currentField:t,data:r,errors:{...D,...I},processing:z,fields:o,currentFieldData:l,isEnhancingDescription:k,canProceed:Y,getCurrentFieldIndex:O,getProgressPercentage:Q,isLastField:U,isGeneratingField:h,generatingFieldName:F,fieldErrors:I,shouldShowAiButton:Z,isAiButtonDisabled:ee,hasMinimumWords:te,hasRequiredDataForAI:ne,handleStatusSelect:R,handleIndustrySelect:A,handleBusinessTypeSelect:W,handleNext:S,handlePrevious:q,handleSubmit:b,handleKeyPress:G,handleInputChange:K,handleNextStep:$,setCurrentField:c,setData:d,enhanceAiDescription:C,generateFieldSuggestion:E}}function Oe({auth:L,industries:P=[],businessTypes:i=[]}){const{t:v,i18n:_}=J(),p=_.dir()==="rtl",{step:f,projectStatus:T,currentField:t,data:c,errors:k,fields:B,currentFieldData:h,isEnhancingDescription:g,canProceed:F,getCurrentFieldIndex:x,getProgressPercentage:I,isLastField:m,isGeneratingField:r,generatingFieldName:d,fieldErrors:N,shouldShowAiButton:z,isAiButtonDisabled:D,handleStatusSelect:o,handleIndustrySelect:w,handleBusinessTypeSelect:R,handlePrevious:A,handleKeyPress:W,handleInputChange:q,handleNextStep:S,setData:b,enhanceAiDescription:G,generateFieldSuggestion:K}=_e({industries:P,businessTypes:i});console.log("Current step in Create component:",f);const M=(E=>!E||!E.trim()?0:E.trim().split(/\s+/).length)(c.description)>=3,C=c.name&&c.business_type_id&&c.industry_id;return u.jsxs(ie,{user:L.user,children:[u.jsx(se,{title:v("create_project")}),u.jsxs("div",{className:"min-h-screen flex items-center justify-center pt-32 pb-12 md:pt-40 md:pb-16 lg:pt-24 lg:pb-16 px-3 sm:px-4 lg:px-4 relative",children:[u.jsx(oe,{}),u.jsx("div",{className:"w-full max-w-sm sm:max-w-lg md:max-w-2xl lg:max-w-3xl",children:u.jsxs(fe,{mode:"wait",children:[f==="select"&&u.jsx(ae,{projectStatus:T,onStatusSelect:o}),f==="industry"&&u.jsx(le,{industries:P,selectedIndustryId:c.industry_id,customIndustryName:c.custom_industry,onIndustrySelect:w,onBack:A}),f==="businessType"&&u.jsx(ce,{businessTypes:i,selectedBusinessTypeId:c.business_type_id,onBusinessTypeSelect:R,onBack:A}),f==="details"&&u.jsx(de,{fields:B,currentField:t,currentFieldData:h,data:c,errors:k,canProceed:F,isLastField:m,getCurrentFieldIndex:x,getProgressPercentage:I,onInputChange:q,onKeyPress:W,onNextStep:S,onPrevious:A,isRTL:p,onEnhanceDescription:G,isEnhancingDescription:g,hasMinimumWords:M,hasRequiredDataForAI:C,setData:b,shouldShowAiButton:z,isAiButtonDisabled:D,onGenerateField:K,isGeneratingField:r,generatingFieldName:d,fieldErrors:N}),f==="creating"&&u.jsx(ue,{}),f==="success"&&u.jsx(pe,{})]})})]}),u.jsx(me,{})]})}export{Oe as default};
