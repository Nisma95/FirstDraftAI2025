import{r as y,m as re,a as H,j as d,L as se}from"./app-Q2KDsHL9.js";import{A as ie}from"./AuthenticatedLayout-D93G_euz.js";import{T as oe}from"./TopTools-BOkEdqpQ.js";import{u as J}from"./useTranslation-CjomllpJ.js";import ae from"./ProjectStatusStep-BDot2tDz.js";import le from"./IndustrySelectionStep-pvjdGXNs.js";import ce from"./BusinessTypeSelectionStep-Vh6_0xZI.js";import de from"./ProjectDetailsStep-B-kc-Zz2.js";import ue from"./CreatingStep-snED3cN1.js";import pe from"./SuccessStep-H7vKO5dn.js";import me from"./BackgroundAnimationStyles-C7KrMzP6.js";import{A as fe}from"./index-B2dGOinC.js";import"./StarBackground-g68PfVH5.js";import"./ApplicationLogo-C1NYi92B.js";import"./LanguageSwitcher-BEakqEvS.js";import"./createLucideIcon-BBISsQlN.js";import"./ProjectCreationHeader-BYnk1Lyh.js";import"./proxy-C5MFVkec.js";import"./chevron-right-DF2kdtex.js";import"./FormField-BGZQ2J0H.js";import"./sparkles-DKr2w2Ec.js";import"./NextButton-P7GqJdfF.js";import"./slash-DLB9Dsv_.js";import"./CustomScrollbarStyles-BMjMKN6l.js";import"./check-CMku1C0v.js";function _e({industries:X=[],businessTypes:P=[]}){const{t:i,i18n:v}=J(),[_,u]=y.useState("select"),[f,T]=y.useState(null),[t,c]=y.useState("name"),[b,B]=y.useState(!1),[h,g]=y.useState(!1),[F,x]=y.useState(null),[I,p]=y.useState({}),{data:n,setData:m,post:L,processing:N,errors:z}=re({name:"",description:"",status:"",industry_id:"",business_type_id:"",target_market:"",location:"",main_product_service:"",team_size:"",project_scale:"",revenue_model:"",main_differentiator:""}),o=[{key:"name",label:i("project_name"),placeholder:i("enter_project_name"),maxLength:255,showAiButton:!1},{key:"description",label:i("project_description"),placeholder:i("strat_writing_the_ai_will_help_you_enhance_it"),type:"textarea",showAiButton:!1},{key:"target_market",label:i("target_market"),placeholder:i("enter_target_market"),type:"textarea",maxLength:800,showAiButton:!0},{key:"location",label:i("location"),placeholder:i("enter_location"),type:"textarea",maxLength:255,showAiButton:!0},{key:"main_product_service",label:i("main_product_service"),placeholder:i("describe_main_product_service"),type:"textarea",showAiButton:!0},{key:"team_size",label:i("team_size"),placeholder:i("enter_team_size"),type:"number",min:1,max:9999,showAiButton:!1},{key:"project_scale",label:i("project_scale"),placeholder:i("select_project_scale"),type:"select",showAiButton:!1,options:[{value:"small",label:i("small_project")},{value:"medium",label:i("medium_project")},{value:"large",label:i("large_project")}]},{key:"revenue_model",label:i("revenue_model"),placeholder:i("describe_revenue_model"),type:"textarea",maxLength:500,showAiButton:!0},{key:"main_differentiator",label:i("main_differentiator"),placeholder:i("describe_main_differentiator"),type:"textarea",showAiButton:!0}];y.useEffect(()=>{var e;_==="details"&&!o.some(s=>s.key===t)&&c(((e=o[0])==null?void 0:e.key)||"name")},[_,t,o]);const w=(e,s)=>{const r=o.find(a=>a.key===e);if(!r)return null;if(!s&&e!=="team_size"&&e!=="project_scale")return i("field_required");if(r.maxLength&&s&&s.length>r.maxLength)return i("max_length_error",{length:r.maxLength});if(e==="team_size"&&s){const a=parseInt(s);if(isNaN(a)||a<1)return i("min_value_error",{min:1})}return null},D=e=>{const s=e?"existed_project":"new_project";T(e),m("status",s),u("industry")},A=e=>{m("industry_id",parseInt(e)),u("businessType")},R=e=>{m("business_type_id",parseInt(e)),u("details")},W=()=>{if(_==="industry")u("select");else if(_==="businessType")u("industry");else if(_==="details"){const e=o.findIndex(s=>s.key===t);e>0?c(o[e-1].key):u("businessType")}},S=()=>{const e=o.findIndex(r=>r.key===t),s=w(t,n[t]);if(s){p(r=>({...r,[t]:s}));return}else p(r=>{const a={...r};return delete a[t],a});e<o.length-1&&c(o[e+1].key)},j=()=>{let e=!1;const s={};if(o.forEach(r=>{const a=w(r.key,n[r.key]);a&&(s[r.key]=a,e=!0)}),e){p(s);const r=o.find(a=>s[a.key]);r&&c(r.key);return}p({}),u("creating"),L(route("projects.store"),{onSuccess:()=>{u("success"),setTimeout(()=>{window.location.href=route("projects.index")},2e3)},onError:r=>{const a={};let V=!1;if(Object.keys(r).forEach(k=>{o.some(O=>O.key===k)&&(a[k]=r[k],V=!0)}),V){p(a);const k=o.find(O=>a[O.key]);k&&c(k.key)}u("details")}})},q=e=>{if(e.key==="Enter"&&(l==null?void 0:l.type)!=="textarea"&&(l==null?void 0:l.type)!=="select"){e.preventDefault();const s=o.findIndex(r=>r.key===t);n[t]&&n[t].toString().trim()&&(s<o.length-1?S():j())}else if(e.key==="Enter"&&e.ctrlKey&&(l==null?void 0:l.type)==="textarea"){e.preventDefault();const s=o.findIndex(r=>r.key===t);n[t]&&n[t].toString().trim()&&(s<o.length-1?S():j())}},G=e=>{if(t==="team_size"){const s=parseInt(e.target.value);(s>=0||e.target.value==="")&&(m(t,e.target.value),(s>0||e.target.value==="")&&p(r=>{const a={...r};return delete a[t],a}))}else{m(t,e.target.value);const s=o.find(r=>r.key===t);s&&s.maxLength&&e.target.value.length>s.maxLength?p(r=>({...r,[t]:i("max_length_error",{length:s.maxLength})})):p(r=>{const a={...r};return delete a[t],a})}},$=()=>{const e=o.findIndex(r=>r.key===t),s=w(t,n[t]);if(s){p(r=>({...r,[t]:s}));return}e<o.length-1?S():j()},K=async()=>{if(!(h||!n.industry_id||!n.business_type_id)){g(!0),x(t);try{const e=await H.post(route("ai.generate-field"),{field:t,project_data:{name:n.name,description:n.description,industry_id:n.industry_id,business_type_id:n.business_type_id},language:v.language},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});e.data&&e.data.content&&m(t,e.data.content)}catch(e){console.error(`Failed to generate content for ${t}:`,e)}finally{g(!1),x(null)}}},C=async()=>{if(!(h||b||!n.industry_id||!n.business_type_id)&&!(!n[t]||!n[t].trim())){t==="description"?B(!0):(g(!0),x(t));try{const e=await H.post(route("ai.enhance-field"),{field:t,current_content:n[t],project_data:{name:n.name,description:n.description,industry_id:n.industry_id,business_type_id:n.business_type_id},language:v.language},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});e.data&&e.data.content&&m(t,e.data.content)}catch(e){console.error(`Failed to enhance content for ${t}:`,e)}finally{t==="description"?B(!1):(g(!1),x(null))}}},E=()=>{n[t]&&n[t].trim()?C():K()},l=o.find(e=>e.key===t)||o[0],M=()=>o.findIndex(e=>e.key===t)+1,Q=()=>Math.round(M()/o.length*100),U=()=>M()===o.length,Y=()=>I[t]||h&&F===t||b&&t==="description"?!1:t==="team_size"?n[t]===""||n[t]&&parseInt(n[t])>0:(l==null?void 0:l.type)==="select"?!0:n[t]&&n[t].toString().trim(),Z=(l==null?void 0:l.showAiButton)||!1,ee=!n.industry_id||!n.business_type_id,te=(e=>!e||!e.trim()?0:e.trim().split(/\s+/).length)(n.description)>=3,ne=n.name&&n.business_type_id&&n.industry_id;return{step:_,projectStatus:f,currentField:t,data:n,errors:{...z,...I},processing:N,fields:o,currentFieldData:l,isEnhancingDescription:b,canProceed:Y,getCurrentFieldIndex:M,getProgressPercentage:Q,isLastField:U,isGeneratingField:h,generatingFieldName:F,fieldErrors:I,shouldShowAiButton:Z,isAiButtonDisabled:ee,hasMinimumWords:te,hasRequiredDataForAI:ne,handleStatusSelect:D,handleIndustrySelect:A,handleBusinessTypeSelect:R,handleNext:S,handlePrevious:W,handleSubmit:j,handleKeyPress:q,handleInputChange:G,handleNextStep:$,setCurrentField:c,setData:m,enhanceAiDescription:C,generateFieldSuggestion:E}}function Ke({auth:X,industries:P=[],businessTypes:i=[]}){const{t:v,i18n:_}=J(),u=_.dir()==="rtl",{step:f,projectStatus:T,currentField:t,data:c,errors:b,fields:B,currentFieldData:h,isEnhancingDescription:g,canProceed:F,getCurrentFieldIndex:x,getProgressPercentage:I,isLastField:p,isGeneratingField:n,generatingFieldName:m,fieldErrors:L,shouldShowAiButton:N,isAiButtonDisabled:z,handleStatusSelect:o,handleIndustrySelect:w,handleBusinessTypeSelect:D,handlePrevious:A,handleKeyPress:R,handleInputChange:W,handleNextStep:S,setData:j,enhanceAiDescription:q,generateFieldSuggestion:G}=_e({industries:P,businessTypes:i});console.log("Current step in Create component:",f);const K=(E=>!E||!E.trim()?0:E.trim().split(/\s+/).length)(c.description)>=3,C=c.name&&c.business_type_id&&c.industry_id;return d.jsxs(ie,{user:X.user,children:[d.jsx(se,{title:v("create_project")}),d.jsxs("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 relative",children:[d.jsx(oe,{}),d.jsx("div",{className:"w-full max-w-3xl",children:d.jsxs(fe,{mode:"wait",children:[f==="select"&&d.jsx(ae,{projectStatus:T,onStatusSelect:o}),f==="industry"&&d.jsx(le,{industries:P,selectedIndustryId:c.industry_id,onIndustrySelect:w,onBack:A}),f==="businessType"&&d.jsx(ce,{businessTypes:i,selectedBusinessTypeId:c.business_type_id,onBusinessTypeSelect:D,onBack:A}),f==="details"&&d.jsx(de,{fields:B,currentField:t,currentFieldData:h,data:c,errors:b,canProceed:F,isLastField:p,getCurrentFieldIndex:x,getProgressPercentage:I,onInputChange:W,onKeyPress:R,onNextStep:S,onPrevious:A,isRTL:u,onEnhanceDescription:q,isEnhancingDescription:g,hasMinimumWords:K,hasRequiredDataForAI:C,setData:j,shouldShowAiButton:N,isAiButtonDisabled:z,onGenerateField:G,isGeneratingField:n,generatingFieldName:m,fieldErrors:L}),f==="creating"&&d.jsx(ue,{}),f==="success"&&d.jsx(pe,{})]})})]}),d.jsx(me,{})]})}export{Ke as default};
